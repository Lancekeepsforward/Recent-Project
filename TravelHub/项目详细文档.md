# 旅行中心（TravelHub）网站开发项目文档

## 一、项目基本信息
- 项目启动日期：2024年6月12日
- 技术栈：
  - 后端语言：Python
  - Web框架：Flask
  - 数据库：MySQL
  - 前端技术：HTML/CSS/JavaScript
  - 认证管理：Flask-Login
  - 数据库ORM：Flask-SQLAlchemy
  - 密码安全：Werkzeug（密码哈希）

---

## 二、需求与实现对应关系
### 2.1 数据库需求与代码实现
#### 需求概述（来自project_guidline.md）：
1. 创建名为"TravelHub"的MySQL数据库
2. 包含3张核心表：用户表（user）、度假村表（resorts）、用户-度假村关联表（user_resorts）
3. 字段要求：
   - 用户表：ID、用户名（唯一）、密码（8-13位，含大小写+特殊字符）、创建时间
   - 度假村表：ID、国家（必填）、州/省、城市、县、名称（必填）、本地图片路径、类型（枚举）
   - 关联表：ID、用户ID、度假村ID、创建时间、推荐指数（1-10）、消费金额、评论
4. 包含管理员账户（用户名：admit，密码：world_peace）

#### 代码实现细节（来自app.py）：
```python:%2FUsers%2Fsclance%2FDesktop%2FRecent%20Project%2Fapp.py
# 用户模型（对应user表）
class User(UserMixin, db.Model):
    id = db.Column(db.Integer, primary_key=True)  # 自增主键
    username = db.Column(db.String(80), unique=True, nullable=False)  # 唯一用户名（长度限制80）
    password_hash = db.Column(db.String(128))  # 存储哈希后的密码（Werkzeug生成）
    created_at = db.Column(db.DateTime, default=datetime.utcnow)  # 自动记录创建时间（UTC）
    resorts = db.relationship('UserResort', backref='user', lazy=True)  # 与关联表的一对多关系

# 度假村模型（对应resorts表）
class Resort(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    country = db.Column(db.String(100), nullable=False)  # 国家字段必填（长度100）
    state = db.Column(db.String(100))  # 州/省（可选）
    city = db.Column(db.String(100))  # 城市（可选）
    county = db.Column(db.String(100))  # 县（可选）
    resort_name = db.Column(db.String(200), nullable=False)  # 名称必填（长度200）
    picture_local_address = db.Column(db.String(500))  # 图片路径（长度500）
    # 度假村类型枚举（覆盖10种类型）
    resort_type = db.Column(db.Enum('Beach', 'Mountain', 'Spa', 'Adventure', 'Cultural', 'Urban', 'Rural', 'Luxury', 'Budget', 'Family'), nullable=False)
    user_resorts = db.relationship('UserResort', backref='resort', lazy=True)  # 与关联表的一对多关系

# 用户-度假村关联模型（对应user_resorts表）
class UserResort(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)  # 用户外键
    resort_id = db.Column(db.Integer, db.ForeignKey('resort.id'), nullable=False)  # 度假村外键
    created_at = db.Column(db.DateTime, default=datetime.utcnow)  # 自动记录创建时间
    recommendation = db.Column(db.Integer)  # 推荐指数（1-10分）
    expenditure = db.Column(db.Float)  # 消费金额（浮点型）
    comment = db.Column(db.Text)  # 评论（长文本类型）